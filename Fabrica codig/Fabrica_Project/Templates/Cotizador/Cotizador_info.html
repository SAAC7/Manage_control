{% extends 'tables.html' %}

{% block botones%}
<div class="container-fluid">
    <div class="text-center">
        <br>
        <h1>Presupuesto {{presupuesto.id}}</h1>
        <h4>{{presupuesto.estado}}</h4>
    </div>
    <br>
    <div class="row">
        <div class="col-md-6">
            <label for="cliente">Descripción:</label>
            <input type="text" class="form-control form-control-user" name="cliente" id="cliente" readonly value="{{presupuesto.cliente}}">
        </div>
        <div class="col-md-6">
            <label for="presupuesto_desc">Descripción:</label>
            <textarea class="form-control form-control-user" readonly name="presupuesto_desc">{{ presupuesto.descripcion }}</textarea>
        </div>
    </div>
    <br>
    <div class="row justify-content-end">
        <div class="col-md-12 col-lg-6 text-right">
            <a class="btn btn-success btn-lg" href="#">Subir Diseño</a>
        </div>
    </div>
    <br>
    <div class="row">
        <div class="col">
            <h4>Cotizaciones previas</h4>
        </div>
    </div>
</div>
{% endblock %}

{% load static %}


{% block head %}
{% if user.is_superuser or user.groups.all.0.name == "Administrador" %}
<th>Asesor</th>
{% endif %}
<th>ID</th>
<th>Fecha</th>
<th>Estado</th>
<th>Diseño</th>
<th>Cotizacion</th>

{% endblock %}

{% block tbody %}
{% for diseno in pres %}
<tr>
    {% if user.is_superuser or user.groups.all.0.name == "Administrador" %}
    <td>{{ diseno.usuario.first_name}} {{ diseno.usuario.last_name}}</td>
    {% endif %}
    <td>{{ diseno.id }}</td>
    <td>{{ diseno.fecha }}</td>
    <td>{{ diseno.estado }}</td>
    <td>
        <div>
            {% if diseno.estado == 'Esperando aprobación' %}
            <a class="btn btn-success btn-sm btn-block" href="/Presupuesto/Diseno/Aprobar/{{presupuesto.id }}/{{diseno.id }}">Aprobar</a>
            <a class="btn btn-danger btn-sm btn-block" href="/Presupuesto/Diseno/Rechazar/{{presupuesto.id }}/{{diseno.id }}">Rechazar</a>
            {% endif %}
            <a class="btn btn-info btn-sm btn-block" href="{% url 'descargar_archivo' id=diseno.id %}" download>
                Descargar
            </a>
        </div>
    </td>
    <td>
        {% for cotizacion in cotizaciones_por_diseno.diseno.id %}
        <p>Cotización {{ cotizacion.id }}: {{ cotizacion.archivo.url }}</p>
    {% endfor %}
    </td>
</tr>
{% endfor %}


{% endblock %}

{% block footer %}
{% if user.is_superuser or user.groups.all.0.name == "Administrador" %}
<th>Asesor</th>
{% endif %}
<th>ID</th>
<th>Fecha</th>
<th>Estado</th>
<th>Diseño</th>
<th>Cotizacion</th>

{% endblock %}